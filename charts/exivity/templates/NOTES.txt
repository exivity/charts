{{- if not .Release.IsUpgrade }}
Thank you for choosing Exivity!

{{- if not (and (empty .Values.secret.appKey) (empty .Values.secret.jwtSecret)) }}
You have chosen to provide your own secrets.
{{- else }}
You have chosen to let Exivity generate secrets for you.
{{- end }}
{{- end }}
{{- if not (and (empty .Values.secret.appKey) (empty .Values.secret.jwtSecret)) }}
PLEASE REMOVE YOUR SECRETS FROM YOUR `values.yaml` FILE BEFORE COMMITTING TO SOURCE CONTROL!
{{- end}}

{{ if not .Release.IsUpgrade -}}Installed{{- else -}}Upgraded{{- end }} Exivity v{{ .Chart.Version }} as `{{ include "exivity.fullname" $ }}`.
It can take a few minutes for the containers to download and start up.

{{- if and .Values.rabbitmq.enabled .Release.IsUpgrade .Values.rabbitmq.nameOverride }}

===============================================
 RabbitMQ UPGRADE INFORMATION
===============================================

A new RabbitMQ instance has been deployed alongside your existing one:

  OLD INSTANCE: {{ include "exivity.fullname" $ }}-rabbitmq
  NEW INSTANCE: {{ include "exivity.fullname" $ }}-{{ .Values.rabbitmq.nameOverride }}

✅ NEXT STEPS:

1. Verify both instances are running:
   # Old RabbitMQ (if still exists):
   kubectl get pods -l app.kubernetes.io/name=rabbitmq -n <your-namespace>
   
   # New RabbitMQ (with nameOverride):
   kubectl get pods -l app.kubernetes.io/name={{ .Values.rabbitmq.nameOverride }} -n <your-namespace>

2. Check new RabbitMQ service is available:
   kubectl get svc {{ include "exivity.fullname" $ }}-{{ .Values.rabbitmq.nameOverride }} -n <your-namespace>

3. Your applications will automatically use the new service:
   Service: {{ include "exivity.fullname" $ }}-{{ .Values.rabbitmq.nameOverride }}

4. When ready to clean up the old instance (⚠️  PERMANENT DATA DELETION):
   kubectl delete pvc data-{{ include "exivity.fullname" $ }}-rabbitmq-0 -n <your-namespace>

ℹ️  NOTE: Replace <your-namespace> with your actual Kubernetes namespace.

⚠️  WARNING: Only delete PVCs when you no longer need the old RabbitMQ data!

===============================================
{{- end }}

{{ if $.Values.ingress.enabled -}}
You can start using Exivity at: http{{- if $.Values.ingress.tls.enabled -}}s{{- end -}}://{{ $.Values.ingress.host }}/
{{- else -}}
Exivity is configured without an ingress.
The ui  is set up as a `{{ $.Values.service.glass.serviceType }}` on port: {{ $.Values.service.glass.servicePort }}
The api is set up as a `{{ $.Values.service.proximityApi.serviceType }}` on port: {{ $.Values.service.proximityApi.servicePort }}
{{- end }}
